<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Caracara: React + Dat + Automerge
</title>
    <meta name="description" content="New developments and ideas from the Dat Ecosystem.">
    <link rel="preload" as="font" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700">
    <link rel="stylesheet" href="/css/index.css">
    <link rel="stylesheet" href="/css/prism-base16-monokai.dark.css">
    <link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="Dat Ecosystem Blog">
    <link rel="alternate" href="/feed/feed.json" type="application/json" title="Dat Ecosystem Blog">
    
  </head>
  <body class="post-template">
    <nav class="bb bg-white b--dat-neutral-10 dt w-100 w-100 border-box pa3 ph5-l">
      <div class="dtc v-mid w-25 pt2">
        <a href="/" class="link dim" title="Dat Blog Home">
          <div class="dib v-mid link mr2 pb1"><img src="/content/images/2017/08/dat-hexagon.png" class="dat-icon dib w2 h2" alt="Dat Ecosystem"></div>
          <div class="dat-neutral b f3 f2-ns dib-l dn">Dat Ecosystem<span class="dat-neutral-60">&nbsp;Blog</span></div>
        </a>
      </div>

      <div class="dtc v-mid w-75 tr pt2">
        <a class="link dim dat-neutral ttu tracked f3 dib mr3 mr4-ns" href="https://docs.datproject.org" title="Dat Project Documentation">Docs</a>
        <a class="link dim dat-neutral ttu tracked f3 dib mr3 mr4-ns" href="https://dat-ecosystem.org" title="dat-ecosystem.org homepage">Home</a>
      </div>
    </nav>

    
<main id="site-main" class="site-main outer" role="main">
  <div class="inner">
    <article class="post-full post ">
      <header class="post-full-header">
        <section class="post-full-meta">
          <time class="post-full-meta-date" datetime="2019-03-05">5 March 2019</time><span class="date-divider">/</span> <a href="/tags/community/" class="post-tag">Community</a>
        </section>
        <h1 class="f1 mv2 lh-title post-full-title">Caracara: React + Dat + Automerge
</h1>
      </header>
      <figure class="post-full-image" style="background-image: url(/content/images/2019/03/florencia-lewis-617908-unsplash.jpg)">
      </figure>

      <section class="post-full-content"><blockquote>
<p>How to create a simple collaborative editor on the distributed web</p>
</blockquote>
<p>This article was originally written as a GEUT's tech insight document. You can find the original post together with the code here: <a href="https://github.com/geut/caracara">https://github.com/geut/caracara</a></p>
<p>🔗 <code>dat://caracara.hashbase.io/</code></p>
<hr>
<h2 id="introduction%3A-the-idea">Introduction: The idea <a class="direct-link" href="#introduction%3A-the-idea">#</a></h2>
<p>The goal is to combine, <a href="https://github.com/geut/olaf">again</a>, Dat with some web development. The result will be a new experimental app, a mix between two kingdoms. When you combine something like this (at first two different worlds into one) the result does not mean to be the sum of all the benefits or even cons: a complete new thing. Based on this, what can you expect from a web app combined with Dat? You can <a href="https://caracara.hashbase.io/">see it</a> for yourself.</p>
<p>In particular, when we say web app we are talking about PWAs where offline support is something that comes first and although it is not a key feature, it is common in the decentralized world. The addition of Dat plays a part in the efficient spreading of the content among peers.</p>
<p>All in all, we at <a href="https://github.com/geut">GEUT</a> believe that it is worth the effort of exploring these combinations.</p>
<h2 id="start">Start <a class="direct-link" href="#start">#</a></h2>
<p>Remember, our goal is to create a simple collaborative text editor. This means, peer <strong>A</strong> writes some text, shares the copy with other peer, call it <strong>B</strong>, automatically authorizing <strong>B</strong> to be a new writer.</p>
<p>OK, let's start with the bootstrap of our web app. We are going to be using <a href="https://reactjs.org/">React</a> for this matter. More specifically, <code>create-react-app</code> to make things more quickly.</p>
<p><code>npx create-react-app caracara</code></p>
<p>After that,</p>
<p><code>cd caracara &amp;&amp; npm start</code></p>
<p>Great, the app is running locally now. We are going to add a new module called <a href="https://github.com/geut/saga"><code>@geut/saga</code></a>. This will give P2P &quot;powers&quot; to our app. ✨</p>
<h2 id="saga">Saga <a class="direct-link" href="#saga">#</a></h2>
<p><code>Saga</code> is a helper module developed by GEUT, that you can use to easily share operations between peers. You can think about this, like <em>applications chatting each other</em>. On top of this, we can do whatever we want with the operations. In this case, the meaning of the operation will be to <em>regenerate</em> the document history in every peer. Since <code>saga</code> will help us to establish a connection and exchange messages with other peers we need to see how it works.</p>
<p>First, install the dependencies:</p>
<p><code>npm install @geut/saga @geut/discovery-swarm-webrtc</code></p>
<p>Now we need to create a connection, this will allow us to talk with a <em>swarm</em> of peers:</p>
<p>This is an extract of <a href="src/p2p/swarm.js">swarm.js</a></p>
<pre class="language-js"><code class="language-js"><span class="token comment">// saga requires:</span><br><span class="token comment">//   - a [random-access-storage](https://github.com/random-access-storage) compatible module</span><br><span class="token comment">//   - a public key</span><br><span class="token comment">//   - and something that "identifies" the new Dat document</span><br><span class="token keyword">const</span> saga <span class="token operator">=</span> <span class="token function">Saga</span><span class="token punctuation">(</span>ram<span class="token punctuation">,</span> publicKey<span class="token punctuation">,</span> username<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// The initialization of saga is async. We are making sure hyperdb is ready.</span><br><span class="token keyword">await</span> saga<span class="token punctuation">.</span><span class="token function">initialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Then, we create the swarm</span><br><span class="token keyword">const</span> sw <span class="token operator">=</span> <span class="token function">swarm</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>id<span class="token operator">:</span> username<span class="token punctuation">,</span><br>  <span class="token function-variable function">stream</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> saga<span class="token punctuation">.</span><span class="token function">replicate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Now we need to say that this peer want to joins the swarm.</span><br>sw<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token function">signalhub</span><span class="token punctuation">(</span>discoveryKey<span class="token punctuation">,</span> signalUrls<span class="token punctuation">)</span><span class="token punctuation">,</span> webrtcOpts<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token comment">// Have in mind we are using webrtc to connect with other peers.</span><br><span class="token comment">// Webrtc requires a signalhub that is going to be used to discover other peers.</span><br><span class="token comment">// It's only used at first and then the communication is between peers.</span><br><span class="token comment">// Nevertheless, is a central point in our decentralized solution.</span><br><span class="token comment">// We are using the Dat discoveryKey for this purpose.</span><br><br>sw<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'connection'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">peer</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">try</span> <span class="token punctuation">{</span><br>    <span class="token comment">// Finally, when we connect with other peer we let saga knows about it</span><br>    <span class="token keyword">await</span> saga<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>peer<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>These are the important bits of the swarm creation. Now, let's see how we use this inside our app.</p>
<pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> SwarmContext <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">class</span> <span class="token class-name">SwarmProvider</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span><br>  state <span class="token operator">=</span> <span class="token punctuation">{</span><br>    swarmReady<span class="token operator">:</span> <span class="token boolean">false</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">async</span> <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> <span class="token punctuation">{</span> username<span class="token punctuation">,</span> match<span class="token operator">:</span> <span class="token punctuation">{</span> params<span class="token operator">:</span> <span class="token punctuation">{</span> draftId <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span><br>    <span class="token keyword">const</span> swarm <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">initComm</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> draftId<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>      swarm<span class="token punctuation">,</span><br>      swarmReady<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>      hasDraftId<span class="token operator">:</span> <span class="token operator">!</span><span class="token operator">!</span>draftId<br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> <span class="token punctuation">{</span> swarmReady<span class="token punctuation">,</span> swarm<span class="token punctuation">,</span> hasDraftId <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span><br>    <span class="token keyword">const</span> <span class="token punctuation">{</span> children <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span><br>    <span class="token keyword">return</span> swarmReady <span class="token operator">?</span> <span class="token punctuation">(</span><br>      <span class="token operator">&lt;</span>SwarmContext<span class="token punctuation">.</span>Provider <span class="token parameter">value</span><span class="token operator">=></span><br>        <span class="token punctuation">{</span>children<span class="token punctuation">}</span><br>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">SwarmContext.Provider</span></span><span class="token punctuation">></span></span><br>    <span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> <span class="token function-variable function">withSwarm</span> <span class="token operator">=</span> <span class="token parameter">WrappedComponent</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> Component <span class="token punctuation">{</span><br>    <span class="token keyword">static</span> displayName <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">WithSwarm</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>WrappedComponent<span class="token punctuation">.</span>displayName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><br>    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">return</span> <span class="token punctuation">(</span><br>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">SwarmContext.Consumer</span></span><span class="token punctuation">></span></span><span class="token plain-text"><br>          </span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> swarm<span class="token punctuation">,</span> hasDraftId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><br>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">WrappedComponent</span></span><br>              <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">this</span><span class="token punctuation">.</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span><br>              <span class="token attr-name">swarm</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>swarm<span class="token punctuation">}</span></span><br>              <span class="token attr-name">hasDraftId</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>hasDraftId<span class="token punctuation">}</span></span><br>            <span class="token punctuation">/></span></span><br>          <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text"><br>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">SwarmContext.Consumer</span></span><span class="token punctuation">></span></span><br>      <span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<p>As you can see we have created a provider using the React Context API and also a <code>withSwarm</code> HOC for easy consuming using idiomatic React.</p>
<h2 id="the-editor">The editor <a class="direct-link" href="#the-editor">#</a></h2>
<p>Great! We've just achieved the swarm creation phase and we have also shown how to connect <code>saga</code> with our app. Now it's time to start playing a bit with the editor.</p>
<p>There are two new important dependencies at this step:</p>
<p><code>npm install automerge diff-match-patch</code></p>
<p>For this part we are going to highlight the <a href="src/Doc.js">Doc.js</a> and <a href="src/Editor.js">Editor.js</a> components.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> <span class="token punctuation">{</span> swarm <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>swarm<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>attachedEvents<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span><br><br>  swarm<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'join'</span><span class="token punctuation">,</span> <span class="token parameter">data</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'NEW COLLABORATOR'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> <span class="token punctuation">{</span> username <span class="token punctuation">}</span> <span class="token operator">=</span> data<span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> collaborators <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span><br>      collaborators<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>collaborators<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  swarm<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'operation'</span><span class="token punctuation">,</span> <span class="token parameter">data</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> <span class="token punctuation">{</span> username<span class="token punctuation">,</span> operation <span class="token punctuation">}</span> <span class="token operator">=</span> data<span class="token punctuation">;</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>username <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>username<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span><br>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'INCOMING OPERATION'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'new operation from:'</span><span class="token punctuation">,</span> username<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'new operation content:'</span><span class="token punctuation">,</span> operation<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>operation<span class="token punctuation">.</span>peerValue<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span><br>    <span class="token keyword">let</span> newDoc<span class="token punctuation">;</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>doc<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      newDoc <span class="token operator">=</span> Automerge<span class="token punctuation">.</span><span class="token function">applyChanges</span><span class="token punctuation">(</span>Automerge<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> operation<span class="token punctuation">.</span>peerValue<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>      newDoc <span class="token operator">=</span> Automerge<span class="token punctuation">.</span><span class="token function">applyChanges</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>doc<span class="token punctuation">,</span> operation<span class="token punctuation">.</span>peerValue<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// peerValue are automerge changes</span><br>    <span class="token punctuation">}</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>operation<span class="token punctuation">.</span>original<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">this</span><span class="token punctuation">.</span>original <span class="token operator">=</span> operation<span class="token punctuation">.</span>original<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>doc <span class="token operator">=</span> newDoc<span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token parameter">prevState</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span><br>      text<span class="token operator">:</span> newDoc<span class="token punctuation">.</span>text<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>      localHistory<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>localHistory<span class="token punctuation">,</span> operation<span class="token punctuation">.</span>diff<span class="token punctuation">]</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> attachedEvents<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token comment">// Remember to remove listeners on unmount!</span><br>  <span class="token keyword">const</span> <span class="token punctuation">{</span> swarm <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>swarm <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> swarm<span class="token punctuation">.</span><span class="token function">removeAllListeners</span><span class="token punctuation">(</span><span class="token string">'operation'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<p>At component's mount we setup <code>saga</code> to be listening to new operations. In our case, operations are <code>Automerge</code> changes. As soon as an operation arrives, we apply it. (There is a special case which is the  document creation, that's why we use <code>Automerge.init()</code>, instead of the previous state: <code>this.doc</code>)</p>
<p>Next, we have the <code>updatePeerValue</code> function. For the sake of simplicity we are not using anything extra to maintain state. So, we will be passing down this function to our child component: the Editor. The Editor maintains a simple textarea component, as you can imagine when the textarea changes, that will trigger our <code>updatePeerValue</code> function.</p>
<p>We will use two important libraries:</p>
<ul>
<li><a href="https://github.com/automerge/automerge">Automerge</a> will handle document transformations. It will give us changes that we can apply later. Automerge helps us maintain a <a href="https://en.wikipedia.org/wiki/Conflict-free_replicated_data_type">CRDT</a> data structure, this is super useful when doing collaborative work. 🆒</li>
<li><a href="https://github.com/google/diff-match-patch">diff-match-patch</a> is an excellent library from Google that we are going to use to differentiate the type of changes between previous and current text state. This in conjunction with Automerge creates a pretty solid strategy for handling and distributing changes without conflicts over a network, a decentralized one in our case.</li>
</ul>
<p>Now let's go through the <code>updatePeerValue</code> function because it does several things actually.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token function-variable function">updatePeerValue</span> <span class="token operator">=</span> <span class="token parameter">val</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> <span class="token punctuation">{</span> comm<span class="token punctuation">,</span> username <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span><br>  <span class="token keyword">const</span> <span class="token punctuation">{</span> text <span class="token punctuation">}</span> <span class="token operator">=</span> val<span class="token punctuation">;</span> <span class="token comment">// this is what the user wrote</span><br><br>  <span class="token comment">// This is a simple way to detect the document autor</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>original <span class="token operator">&amp;&amp;</span> comm<span class="token punctuation">.</span>db<span class="token punctuation">.</span>local<span class="token punctuation">.</span>secretKey<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token comment">// It is super important to share the doc:creation change first and</span><br>    <span class="token comment">// then all the progressive changes.</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>doc <span class="token operator">=</span> Automerge<span class="token punctuation">.</span><span class="token function">change</span><span class="token punctuation">(</span>Automerge<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'doc:creation'</span><span class="token punctuation">,</span> <span class="token parameter">doc</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>      doc<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Automerge<span class="token punctuation">.</span>Text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> creationChange <span class="token operator">=</span> Automerge<span class="token punctuation">.</span><span class="token function">getChanges</span><span class="token punctuation">(</span>Automerge<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>doc<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>original <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// here we are sharing a new operation related to the document creation</span><br>    <span class="token comment">// the last param: diff is used to share the history message</span><br>    comm<span class="token punctuation">.</span><span class="token function">writeOperation</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>      peerValue<span class="token operator">:</span> creationChange<span class="token punctuation">,</span><br>      username<span class="token punctuation">,</span><br>      original<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>original<span class="token punctuation">,</span><br>      diff<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>username<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> created the doc - </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">stamp</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token comment">// this.dmp is a instance of diff-match-patch</span><br>  <span class="token comment">// the usage of diff-match-patch here is based on https://lorefnon.tech/2018/09/23/using-google-diff-match-patch-with-automerge-text/</span><br>  <span class="token comment">// Remember, our underlying editor is a simple textarea, so we need to detect specific modifications that happens to the text</span><br><br>  <span class="token keyword">const</span> diff <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>dmp<span class="token punctuation">.</span><span class="token function">diff_main</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>text<span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">this</span><span class="token punctuation">.</span>dmp<span class="token punctuation">.</span><span class="token function">diff_cleanupSemantic</span><span class="token punctuation">(</span>diff<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> patches <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>dmp<span class="token punctuation">.</span><span class="token function">patch_make</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>text<span class="token punctuation">,</span> diff<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">const</span> <span class="token function-variable function">updateAutomerge</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">baseDoc<span class="token punctuation">,</span> message<span class="token punctuation">,</span> opFn</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> Automerge<span class="token punctuation">.</span><span class="token function">change</span><span class="token punctuation">(</span>baseDoc<span class="token punctuation">,</span> message<span class="token punctuation">,</span> <span class="token parameter">doc</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>      <span class="token function">opFn</span><span class="token punctuation">(</span>doc<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>  patches<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">patch</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">let</span> idx <span class="token operator">=</span> patch<span class="token punctuation">.</span>start1<span class="token punctuation">;</span><br>    <span class="token keyword">let</span> historyMessage <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span><br>    <span class="token keyword">let</span> newDoc<span class="token punctuation">;</span><br>    patch<span class="token punctuation">.</span>diffs<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>operation<span class="token punctuation">,</span> changeText<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>      <span class="token keyword">switch</span> <span class="token punctuation">(</span>operation<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span> <span class="token comment">// Insertion</span><br>          historyMessage <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>username<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> added some text (</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>changeText<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">) - </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">stamp</span><span class="token punctuation">(</span><br>            <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>          <span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br>          newDoc <span class="token operator">=</span> <span class="token function">updateAutomerge</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>doc<span class="token punctuation">,</span> historyMessage<span class="token punctuation">,</span> <span class="token parameter">doc</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>            doc<span class="token punctuation">.</span>text<span class="token punctuation">.</span><span class="token function">insertAt</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span> <span class="token operator">...</span>changeText<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>          idx <span class="token operator">+=</span> changeText<span class="token punctuation">.</span>length<span class="token punctuation">;</span><br>          <span class="token keyword">break</span><span class="token punctuation">;</span><br>        <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span> <span class="token comment">// No Change</span><br>          idx <span class="token operator">+=</span> changeText<span class="token punctuation">.</span>length<span class="token punctuation">;</span><br>          newDoc <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><br>          <span class="token keyword">break</span><span class="token punctuation">;</span><br>        <span class="token keyword">case</span> <span class="token operator">-</span><span class="token number">1</span><span class="token operator">:</span> <span class="token comment">// Deletion</span><br>          historyMessage <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>username<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> removed some text (</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>changeText<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">) - </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">stamp</span><span class="token punctuation">(</span><br>            <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>          <span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br>          newDoc <span class="token operator">=</span> <span class="token function">updateAutomerge</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>doc<span class="token punctuation">,</span> historyMessage<span class="token punctuation">,</span> <span class="token parameter">doc</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> changeText<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>              doc<span class="token punctuation">.</span>text<span class="token punctuation">.</span><span class="token function">deleteAt</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span><br>            <span class="token keyword">return</span> doc<span class="token punctuation">;</span><br>          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>          <span class="token keyword">break</span><span class="token punctuation">;</span><br>        <span class="token keyword">default</span><span class="token operator">:</span><br>          <span class="token keyword">break</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br>      <span class="token keyword">if</span> <span class="token punctuation">(</span>newDoc<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token comment">// thanks to diff-match-patch we can apply the specific change (insert, delete) to Automerge Text.</span><br>        <span class="token comment">// Now we get the changes so we can share it with our peers.</span><br>        <span class="token keyword">const</span> changes <span class="token operator">=</span> Automerge<span class="token punctuation">.</span><span class="token function">getChanges</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>doc<span class="token punctuation">,</span> newDoc<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">this</span><span class="token punctuation">.</span>doc <span class="token operator">=</span> newDoc<span class="token punctuation">;</span><br>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><br>          <span class="token punctuation">{</span><br>            text<span class="token punctuation">,</span><br>            localHistory<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>localHistory<span class="token punctuation">,</span> changes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>message<span class="token punctuation">]</span><br>          <span class="token punctuation">}</span><span class="token punctuation">,</span><br><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>            <span class="token comment">// NOTE(dk): here we are sharing changes we made locally with our peers.</span><br>            comm<span class="token punctuation">.</span><span class="token function">writeMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>              peerValue<span class="token operator">:</span> changes<span class="token punctuation">,</span><br>              username<span class="token punctuation">,</span><br>              diff<span class="token operator">:</span> changes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>message<br>            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>          <span class="token punctuation">}</span><br>        <span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<p>Last but not least, the editor, this is the simplest piece of the whole project.</p>
<p>Here are the important bits.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token function-variable function">onChange</span> <span class="token operator">=</span> <span class="token parameter">e</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> <span class="token punctuation">{</span> value<span class="token punctuation">,</span> selectionStart <span class="token punctuation">}</span> <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">;</span><br>  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><br>    <span class="token punctuation">{</span><br>      value<span class="token punctuation">,</span><br>      selectionStart<br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>selectionStart <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setCaretToPos</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>taRef<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>selectionStart<span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">updatePeerValue</span><span class="token punctuation">(</span><span class="token punctuation">{</span> text<span class="token operator">:</span> value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token comment">// Note(dk): a deboung will be better to not overload network</span><br>  <span class="token comment">// but is making things difficult with the UX.</span><br>  <span class="token comment">// Im going to revisit this strategy later, it requires a big refactor.</span><br>  <span class="token comment">// this.debouncedPeerValue({ text: value });</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<p>The editor renders a textarea component with an <code>onChange</code> function attached to it. The <code>onChange</code> function updates the local value and call the <code>updatePeerValue</code> function that we have just seen.</p>
<h2 id="caveats">Caveats <a class="direct-link" href="#caveats">#</a></h2>
<p>The app is not totally decentralized. It is good to know this from the very beginning. We need to use some signaling servers to bootstrap the discovery of peers. From that point onwards, the communication is among peers. Another <em>centralized</em> moment is the first download of the app. This can be a github page, a CDN or whatever you want to use. Again, if the app works as a PWA with offline support, additional downloads will not be necessary.</p>
<h2 id="conclusions">Conclusions <a class="direct-link" href="#conclusions">#</a></h2>
<p>We have just dealt with the development of a <strong>Dat powered web app</strong>. Let's summarize the important parts:</p>
<ol>
<li>Install and instantiate <code>saga</code>. This is a top level interface on top of <code>hyperdb</code>.</li>
<li>Create the swarm. This is useful to find another peers. Since we are creating a webapp we will be relying on WebRTC for peer to peer communication. A signal server will be required then. You can host your own if you want to. This is <a href="https://github.com/soyuka/signalhubws">the one</a> we recommend these days.</li>
<li>After <code>saga</code> instantiation and swarm creation, we can start playing with our app. :tada:
<ol>
<li>Since we were after a collaborative editor, two modules appear as a good choice here: <code>Automerge</code> and <code>diff-match-patch</code>.</li>
<li>We will share operations that we get from <a href="https://github.com/automerge/automerge#sending-and-receiving-changes">Automerge</a> changes.</li>
<li><code>diff-match-patch</code> is used to extract <code>deltas</code> from plain text.</li>
</ol>
</li>
<li>That's all! 👍</li>
</ol>
<p>As you can see, thinking about sharing operations among peers opens the possibilities for new kind of applications and also makes things a bit easier. Looks like a win-win situation.</p>
<p>I hope this article helps you to start thinking on new possibilities and give it a try to use Dat on the web!</p>
<p><strong>Thanks!</strong> 🦅</p>
<h2 id="acknowledgments">Acknowledgments <a class="direct-link" href="#acknowledgments">#</a></h2>
<p>I want to say <strong>thanks</strong> to the whole <strong>GEUT Team</strong> for their time and support. To Max (<a href="https://github.com/elmasse">@elmasse</a>) for sharing all his UX knowledge and React expertise to polish some rough edges and finally the Dat Project organization for their encouragement and openness. 🤗</p>
<p>📷 <em>Caracara article photo by Florencia Lewis on Unsplash</em></p>
<blockquote>
<p>If you want to contribute please create an issue with your suggestion and we can continue the discussion from there. 👍</p>
</blockquote>
<blockquote>
<p>Also, ⭐️ is ❤️ Well, not really ...but is cool. And you are cool. 😎</p>
</blockquote>
</section>
    </article>
  </div>
</main>
<aside class="read-next outer">
  <div class="inner">
    <div class="read-next-feed">
          
      
  <article class="post-card post ">
    <a class="post-card-image-link" href="/dat-field-notes/">
      <div class="post-card-image" style="background-image: url(https://images.unsplash.com/photo-1454166155302-ef4863c27e70?ixlib=rb-1.2.1&amp;q=80&amp;fm=jpg&amp;crop=entropy&amp;cs=tinysrgb&amp;w=1080&amp;fit=max&amp;ixid=eyJhcHBfaWQiOjExNzczfQ)"></div>
    </a>
    <div class="post-card-content">
      <a class="post-card-content-link" href="/dat-field-notes/">
        <header class="post-card-header">
          <span class="post-card-tags">Community</span>
          <h2 class="post-card-title">Dat Field Notes</h2>
        </header>
        <section class="post-card-excerpt">
          <p>Over the last few years of working on Dat I&#39;ve seen lots of great posts, articles, thoughtful answers to chat questions, and more. After gathering these slowly it is time to share it!
</p>
        </section>
      </a>
    </div>
  </article>

  <article class="post-card post ">
    <a class="post-card-image-link" href="/handshake-funding-brings-in-new-developers-for-dat/">
      <div class="post-card-image" style="background-image: url(https://images.unsplash.com/photo-1490187763999-9f273a5b7516?ixlib=rb-1.2.1&amp;q=80&amp;fm=jpg&amp;crop=entropy&amp;cs=tinysrgb&amp;w=1080&amp;fit=max&amp;ixid=eyJhcHBfaWQiOjExNzczfQ)"></div>
    </a>
    <div class="post-card-content">
      <a class="post-card-content-link" href="/handshake-funding-brings-in-new-developers-for-dat/">
        <header class="post-card-header">
          <span class="post-card-tags">Decentralization</span>
          <h2 class="post-card-title">New funding compensates existing Dat volunteers</h2>
        </header>
        <section class="post-card-excerpt">
          <p>Let&#39;s make it easier to contribute to Dat.
</p>
        </section>
      </a>
    </div>
  </article>


    </div>
  </div>
</aside>


    <footer class="bg-white ph3 ph5-ns pv5 pv6-ns bt b--black-10">
      <div class="mw9 center">
        <div class="mb5 lh-copy">
          <a class="dib v-mid link dim mr3 mt1" href="https://dat-ecosystem.org" title="Dat Ecosystem homepage">
            <img src="/content/images/2017/08/dat-hexagon.png" class=" dat-icon dib br-100" alt="Dat Ecosystem">
          </a>
          <a class="f3 link dat-neutral dim b dib mr3 mb3" href="https://blog.dat-ecosystem.org/" title="Dat Ecosystem Blog">
            Dat Ecosystem Blog
          </a>
        </div>
        <div class="mt4">
          <a class="f3 ba dat-neutral b--dat-neutral no-underline grow b inline-flex items-center mr3 mb3 pv3 ph4" href="https://twitter.com/dat_protocol" title="Follow us on Twitter">
            <div class="dib dat-icon pr2 pt1">
            <svg viewBox="0 0 240 240" fill="currentColor" id='daticon-hexagon-outlines' id='daticon-happy-dat'>
    <title>happy dat</title><path d="M120 240a9 9 0 0 1-4.5-1.21l-96-55.5a9 9 0 0 1-4.5-7.79v-111a9 9 0 0 1 4.5-7.79l96-55.5a9 9 0 0 1 9 0l96 55.5a9 9 0 0 1 4.5 7.79v111a9 9 0 0 1-4.5 7.79l-96 55.5A9 9 0 0 1 120 240zm-87-69.69l87 50.3 87-50.3V69.69L120 19.4 33 69.69z"></path><path d="M120.43 166.34a70.72 70.72 0 0 1-50.33-20.86 9 9 0 0 1 12.73-12.73 53.14 53.14 0 0 0 75.2 0 9 9 0 0 1 12.73 12.73 70.72 70.72 0 0 1-50.33 20.86zm-47-58.73a9 9 0 0 1-9-9V81.39a9 9 0 0 1 18 0v17.22a9 9 0 0 1-9 9zm94 0a9 9 0 0 1-9-9V81.39a9 9 0 0 1 18 0v17.22a9 9 0 0 1-9 9z"></path>
  </svg></div>
            <span>Follow @dat_protocol</span>
          </a>
          <a class="f3 ba dat-neutral b--dat-neutral no-underline grow b inline-flex items-center mr3 mb3 pv3 ph4" href="https://discord.com/invite/dPEKwfrv2D" title="Join our Chat with Discord">
              <div class="dib dat-icon pr2 pt1"><svg viewBox="0 0 240 240" fill="currentColor" id='daticon-hexagon-outlines' id='daticon-question'>
    <title>question</title><path d="M221 56.71l-96-55.5a9 9 0 0 0-9 0l-96 55.5a9 9 0 0 0-4.5 7.79v111a9 9 0 0 0 4.5 7.79l96 55.5a9 9 0 0 0 9 0l96-55.5a9 9 0 0 0 4.5-7.79v-111a9 9 0 0 0-4.5-7.79zM117.44 188.24c-10 0-17.31-7.87-17.31-18.09 0-10.42 7.28-18.29 17.31-18.29s17.5 7.87 17.5 18.29c.01 10.23-7.47 18.09-17.5 18.09zM130.23 140h-25.37c-3.93-26 24.78-37.93 24.78-52.68 0-8.06-5.31-12.28-13.18-12.28-7.28 0-12.59 3.79-17.9 9.1L82.63 69.63c8.85-10.63 21.24-17.89 35.8-17.89 22.22 0 38.94 10.2 38.94 33.41 0 24.39-29.5 31.85-27.14 54.85z"></path>
  </svg></div>
              <span>
                Curious? Join Our Chat with Discord
              </span>
          </a>
          <a class="f3 ba dat-neutral b--dat-neutral no-underline grow b inline-flex items-center mb3 pv3 ph4" href="https://donate.datproject.org" title="Donate to Code for Science & Society">
            <div class="dib dat-icon pt1 pr2">
              <svg viewBox="0 0 240 240" fill="currentColor" id='daticon-star-dat'>
    <title>star-dat</title><path d="M238.34 56.07a10 10 0 0 0-8.07-6.81l-32.88-4.78-14.71-29.8a10 10 0 0 0-17.94 0L150 44.48l-32.88 4.78a10 10 0 0 0-5.54 17.06l23.79 23.19-5.62 32.75a10 10 0 0 0 14.51 10.54l29.41-15.46 29.41 15.46a10 10 0 0 0 14.51-10.54L212 89.51l23.79-23.19a10 10 0 0 0 2.55-10.25z"></path><path d="M199.91 148a9.79 9.79 0 0 0-10 9.74v11l-84.4 48.67-84.34-48.66.06-97.35 84.4-48.74 9.63 5.55a10 10 0 0 0 10-17.33l-14.64-8.43a10 10 0 0 0-10 0L6.23 57a10 10 0 0 0-5 8.65l-.06 108.84a10 10 0 0 0 5 8.67l94.33 54.39a10 10 0 0 0 10 0L204.89 183a10 10 0 0 0 5-8.65v-16.59a9.79 9.79 0 0 0-9.98-9.76z"></path>
  </svg>                </div>
            <span>Donate to Support Public Data</span>
          </a>
        </div>
        <p class="mt4 f3 measure copy lh-copy">
          Dat Ecosystem flourishes because of you, thank you!
          You made it all the way to the bottom.
          Did you count the number of hexagons?
          <br><br>
          Have questions? Join our chat or ask on <a href="https://twitter.com/dat_protocol" class="no-underline underline-hover dat-green">Twitter</a> or <a href="https://github.com/datproject" class="no-underline underline-hover dat-green">Github</a>.
          <br><br>
          <a href="https://blog.dat-ecosystem.org/">Dat Ecosystem Blog</a> &copy; 2021.
          Blogging via <a href="https://www.11ty.dev/" target="_blank">11ty</a>, hosted on <a href="https://github.com/dat-ecosystem/blog" target="_blank">Github</a>.
        </p>
      </div>
    </footer>

    <!-- Current page: /caracara-react-dat-automerge/ -->
  </body>
</html>
